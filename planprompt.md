# Role: 资深的五轴 CAM 算法导师
# User: 2026年6月即将入职的 CAM 算法工程师 (C++/数据结构/STL方向)

## 📅 1. 我们的总战略图 (The Job-Ready Master Plan)
# 🚀 五轴 CAM 开发：从算法原理到工业级内核

**目标岗位：** 五轴 CNC CAM 算法工程师 (专注于 STL/Mesh 处理)
**核心战略：** **双轨并行 (Dual-Track)** —— 理论深度与工程能力的完美平衡。
1.  **架构 (Track B - 90min)：** 使用 C++20、CMake 与 **Part 类** 对象化封装，构建工业级内核。
2.  **内核 (Track A - 30min)：** 深入 **Eigen** 与 **数据结构原理**，拒绝“调包侠”，从底层理解 Hash、图论与稀疏矩阵。
3.  **产出：** 一个高内聚、可演示的 C++ 算法库 (MiniCAM Core)。

---

## 🛠️ 军火库：环境与工具
* **操作系统：** **Windows 10/11** (唯一主力平台)
* **开发 IDE：** **Visual Studio 2022 Community**
* **构建系统：** **CMake 3.25+** (核心工程技能)
* **语言标准：** **C++ 20** (Modules, Concepts, Spans)
* **核心数学库：** **Eigen 3.4+**
* **辅助工具：** **NX** (可视化验证), **MeshLab**, Git

---

## 📅 第一阶段：几何内核与拓扑重构 (Month 1)
**主题：半边结构、对象封装与哈希原理**
> **核心目标：** 建立 `Part` 类作为核心容器，并实现基于 **半边结构 (Half-Edge)** 的拓扑层。这是 CAM 系统的地基。

| 周次 | 📚 Track A: 数据结构理论 (30min) | 🛠️ Track B: MiniCAM 实战 (90min) | ✅ 验收标准 |
| :--- | :--- | :--- | :--- |
| **Week 1** | **内存模型与哈希**<br>- Stack vs Heap (缓存命中率)<br>- Hash 函数原理与冲突解决<br>- 浮点数误差 (Epsilon) 处理 | **基础设施与 Part 类**<br>- **CMake**：搭建 MSVC + Eigen 环境<br>- **Part 类**：封装 `Mesh` 与 `BoundingBox`，作为业务主体<br>- **极速 IO**：利用 `buffer` 一次性读取 STL<br>- **去重**：实现 `Point3D` Hash 进行顶点焊接 | 1. 读取 50MB STL < 0.5秒<br>2. 正方体去重后仅剩 8 个顶点 |
| **Week 2** | **图论基础 (Graph)**<br>- 邻接表 vs 邻接矩阵<br>- 半边结构指针设计 | **手写半边结构 (Half-Edge)**<br>- **(硬骨头)** 实现 `Vertex`, `Edge`, `Face` 指针互指<br>- **拓扑导航**：实现 `next_halfedge` 漫游<br>- **紧凑存储**：使用 `std::vector` + 索引 替代纯指针 | 能够 $O(1)$ 时间遍历任意顶点的“一环邻域” (One-Ring Neighborhood)。 |
| **Week 3** | **离散微分几何基础**<br>- 向量叉乘/点乘的几何意义<br>- 重心坐标 | **混合法向 (Normal)**<br>- 实现按“角度权重”计算顶点法向<br>- 几何属性：计算面积、形心、边界识别 | 导出带有高质量法向的 OBJ，在 MeshLab 中观察表面光照平滑无接缝。 |
| **Week 4** | **树 (Tree) 的概念**<br>- 递归思维 (Recursion)<br>- 树的深度与遍历 | **曲率计算与特征提取**<br>- **曲率估算**：计算离散平均曲率 (Mean Curvature)<br>- **特征识别**：基于曲率阈值，提取模型棱线 | 自动识别出牙齿模型的咬合面边缘线，并以红色显示。 |

---

## 📅 第二阶段：数值优化与网格修复 (Month 2)
**主题：稀疏矩阵与隐式平滑**
> **核心目标：** 掌握高级算法工程师的标配技能——**稀疏线性方程组求解**。

| 周次 | 📚 Track A: 数据结构理论 (30min) | 🛠️ Track B: MiniCAM 实战 (90min) | ✅ 验收标准 |
| :--- | :--- | :--- | :--- |
| **Week 5** | **稀疏矩阵 (Sparse Matrix)**<br>- CSR/CSC 存储格式<br>- 拉普拉斯矩阵性质 | **拉普拉斯算子**<br>- **数学推导**：实现余切权重 (Cotan Weights)<br>- **矩阵构建**：构建 `Eigen::SparseMatrix` | 正确构建拉普拉斯矩阵，验证行和为零特性。 |
| **Week 6** | **线性方程组求解**<br>- Cholesky 分解<br>- 正定矩阵概念 | **隐式网格光顺**<br>- **线性求解**：求解 $(M + \lambda L)x = x_0$ 方程组<br>- **求解器**：使用 `Eigen::SimplicialLLT` | 模型变光滑且**不收缩**，解决“多面体抖动”问题。 |
| **Week 7** | **参数化映射**<br>- 调和映射原理<br>- UV 展开逻辑 | **网格参数化 (初探)**<br>- **UV 映射**：将 3D 曲面映射到 2D 域<br>- **应用**：为后续生成纹理或网格重构做准备 | 将 3D 曲面片无翻转地展平到平面。 |
| **Week 8** | **图的连通性**<br>- BFS/DFS 搜索算法<br>- 拓扑清理逻辑 | **鲁棒性修复 (Repair)**<br>- **拓扑清洗**：自动修复非流形边、重叠点<br>- **补洞算法**：识别边界环并填充 | 输入“垃圾”扫描数据，程序不崩溃并输出干净网格。 |

---

## 📅 第三阶段：空间加速与场规划 (Month 3)
**主题：HPC 与刀路引导场**
> **核心目标：** 解决“慢”的问题，并让刀路顺着曲面“流动”。

| 周次 | 📚 Track A: 数据结构理论 (30min) | 🛠️ Track B: MiniCAM 实战 (90min) | ✅ 验收标准 |
| :--- | :--- | :--- | :--- |
| **Week 9** | **空间分割树**<br>- KD-Tree vs BVH<br>- SAH 启发式构建 | **高性能空间索引**<br>- **AABB 树 (BVH)**：为三角面片构建层次包围盒<br>- **SIMD 加速**：利用 AVX 指令集加速测试 | 碰撞检测/最近点查询速度提升 100 倍。 |
| **Week 10** | **最近邻搜索 (KNN)**<br>- 堆 (Heap) 与剪枝<br>- 距离场 (SDF) 概念 | **距离场与投影**<br>- **点到网格距离**：精确计算空间点到网格的有符号距离<br>- **应用**：刀具干涉预判 | 毫秒级返回任意点到网格的最近距离。 |
| **Week 11** | **矢量场理论**<br>- 梯度、散度与旋度<br>- 主曲率方向 | **标架场 (Frame Field)**<br>- **主曲率方向**：计算网格上的最大/最小主曲率方向<br>- **场平滑**：优化向量场，使其连续 | 可视化出顺滑的引导场，无杂乱跳变。 |
| **Week 12** | **等值面提取**<br>- Marching Cubes 思想<br>- 偏置面几何 | **等距偏置 (Offsetting)**<br>- **顶点偏置**：沿法向移动顶点生成“刀心面”<br>- **自交处理**：简单的局部自交剔除 | 生成扩大后的刀心运行曲面。 |

---

## 📅 第四阶段：五轴运动学与后处理 (Month 4)
**主题：从几何到 G 代码**
> **核心目标：** 结合机床运动学，生成真正可上机的五轴代码。

| 周次 | 📚 Track A: 数据结构理论 (30min) | 🛠️ Track B: MiniCAM 实战 (90min) | ✅ 验收标准 |
| :--- | :--- | :--- | :--- |
| **Week 13** | **曲线插值**<br>- 线性插值 vs 样条 (Spline)<br>- 弧长参数化 | **等残留高度刀路**<br>- **Iso-Scallop**：根据表面斜率动态调整路径行距<br>- **流线生成**：沿着标架场生成刀路 | 刀路疏密均匀，符合曲面特征。 |
| **Week 14** | **四元数 (Quaternion)**<br>- Slerp 插值原理<br>- 欧拉角死锁问题 | **五轴姿态控制**<br>- **四元数插值**：使用 `Eigen::Quaternion` 平滑刀轴<br>- **侧刃切削**：计算 Swarf 加工矢量 | 输出包含 I,J,K 矢量的连续刀位。 |
| **Week 15** | **贪心算法**<br>- 局部最优搜索<br>- 碰撞检测策略 | **碰撞回避 (Gouging)**<br>- **干涉检查**：检测刀具与模型的碰撞<br>- **自动避让**：计算避让角度 (Retract & Tilt) | 在复杂凹陷区域，刀轴能自动倾斜避开干涉。 |
| **Week 16** | **状态机与编译器**<br>- 格式化输出<br>- 坐标变换矩阵 | **RTCP 与 G 代码**<br>- **机床运动学**：AC 摇篮结构变换<br>- **后处理**：生成标准五轴 NC 代码 | 代码导入仿真软件无报警，动作连贯。 |

---

## 📅 第五阶段：项目封包与职场冲刺 (Month 5)
**主题：代码重构、文档与面试准备**
> **核心目标：** 将代码库打磨成“求职作品”，并针对底层技术细节进行模拟答辩。

* **Week 17: 系统级重构** (封装 `.dll`, 统一日志系统)
* **Week 18: 性能分析 (Profiling)** (使用 VS Profiler 优化 Cache Miss)
* **Week 19: 技术文档与 Demo** (录制从读入烂面到生成刀路的全过程)
* **Week 20: 模拟面试 (Mock Interview)** (复盘：为什么用半边结构？为什么用 CSR 格式？)

---

## 📝 2. 当前进度追踪 (Current Status Tracker)
*(请在每次对话开始时更新此部分，以便导师了解你的最新状态)*

**📅 当前时间：** Month [ 1 ] - Week [ 1 ] - Day [ 4 ]
**🚩 本周核心任务：** [ 封装 Part 类，实现极速 Buffer IO 读取，修复性能 Bug ]

**✅ 已完成项 (Done)：**
* [x] CMake 工程架构搭建 (Core/App 分离)
* [x] 基础 STLReader 与 BoundingBox 实现
* [x] 引入 Part 类概念

**🚧 进行中 (In Progress)：**
* [ ] 实现 `Part` 类 (Core/src/Part.cpp)
* [ ] 优化 STLReader 为 Buffer 读取 (reinterpret_cast)
* [ ] 修复 BoundingBox 传值引用 Bug

**❌ 遇到的卡点/问题 (Blockers)：**
* (待填写)

**💡 导师需要的协助：**
* (在此处填写你希望我具体解释的概念或代码...)